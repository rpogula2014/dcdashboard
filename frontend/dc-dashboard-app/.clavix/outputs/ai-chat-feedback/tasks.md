# Implementation Tasks

**Project**: ai-chat-feedback
**Generated**: 2025-12-05T10:20:00Z

---

## Phase 1: Database Setup

- [x] Create PostgreSQL feedback table with schema: id (serial), user_question (text), ai_response (text), dcid (varchar), rating (varchar), feedback_text (text nullable), user_email (varchar), created_at (timestamp default now()) (ref: Data Model)
  Task ID: phase-1-database-setup-1

## Phase 2: Backend API

- [x] Create FastAPI endpoint POST /api/feedback to receive and store feedback data in PostgreSQL (ref: Technical Constraints)
  Task ID: phase-2-backend-api-1

## Phase 3: Frontend Types & Service

- [x] Add FeedbackRating type ('good' | 'bad') and FeedbackPayload interface to types/index.ts (ref: Data Model)
  Task ID: phase-3-frontend-types-service-1

- [x] Create src/services/feedbackService.ts with submitFeedback function using axios to POST to /api/feedback (depends: phase-2-backend-api-1)
  Task ID: phase-3-frontend-types-service-2

## Phase 4: Feedback UI Component

- [x] Create src/components/TalkToData/FeedbackButtons.tsx with thumbs up/down icons, optional text input, and submit handler (ref: Core Requirements)
  Task ID: phase-4-feedback-ui-component-1

- [x] Add CSS styles for feedback buttons and text input in TalkToData.css (subtle, non-intrusive design)
  Task ID: phase-4-feedback-ui-component-2

## Phase 5: Integration

- [x] Add feedback state tracking (feedbackGiven: Map<messageId, rating>) to TalkToData.tsx (ref: Implicit Requirements)
  Task ID: phase-5-integration-1

- [x] Integrate FeedbackButtons into AssistantMessage component in ChatMessage.tsx, passing message data and dcid (depends: phase-4-feedback-ui-component-1)
  Task ID: phase-5-integration-2

- [x] Wire up feedback submission: on rating click, show optional text input, then call submitFeedback with all required fields (user_question from previous user message, ai_response, dcid, rating, text, hardcoded email)
  Task ID: phase-5-integration-3

- [x] Add visual feedback on successful submission (disable buttons, show checkmark or "Thanks!" message)
  Task ID: phase-5-integration-4

## Phase 6: Testing & Verification

- [x] Test feedback flow end-to-end: click thumbs up/down, optionally add text, verify data appears in PostgreSQL
  Task ID: phase-6-testing-verification-1

- [x] Verify all required fields are captured: user_question, ai_response (full JSON with SQL, results, tokens, cost), dcid, rating, feedback_text, timestamp, user_email
  Task ID: phase-6-testing-verification-2

---

## Summary

| Phase | Tasks | Focus |
|-------|-------|-------|
| 1 | 1 | Database table creation |
| 2 | 1 | Backend API endpoint |
| 3 | 2 | Frontend types & service |
| 4 | 2 | UI component |
| 5 | 4 | Integration & wiring |
| 6 | 2 | Testing |

**Total: 12 tasks**

**Dependencies:**
- Phase 3 task 2 depends on Phase 2 (need API endpoint before service)
- Phase 5 tasks depend on Phase 4 (need UI component before integration)

**Notes:**
- Email is hardcoded for now (placeholder for Okta integration)
- User question is retrieved from the previous user message in chat history
- Each AI response has a unique `id` field for feedback association

---

*Generated by Clavix /clavix:plan*
